<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SRI - Global Assessment Protocol</title>
<style>
    /* --- 1. è§†è§‰ç³»ç»Ÿ (System Core) --- */
    :root {
        --bg-color: #f2f4f6;
        --card-bg: rgba(255, 255, 255, 0.85);
        --text-main: #1d1d1f;
        --text-sec: #86868b;
        --accent: #0071e3;
        --shadow-soft: 0 20px 60px rgba(0, 0, 0, 0.08);
        --ease-spring: cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    body {
        margin: 0; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
        background-color: var(--bg-color); height: 100vh;
        display: flex; justify-content: center; align-items: center;
        overflow: hidden; color: var(--text-main);
        -webkit-font-smoothing: antialiased;
    }

    /* --- 2. æå…‰èƒŒæ™¯ (Aurora) --- */
    .aurora-bg {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        z-index: -1; overflow: hidden; background: #f5f5f7;
    }
    .blob { position: absolute; filter: blur(80px); opacity: 0.6; animation: float 20s infinite alternate ease-in-out; }
    .blob-1 { width: 600px; height: 600px; background: #dbeafe; top: -10%; left: -10%; }
    .blob-2 { width: 500px; height: 500px; background: #e0e7ff; bottom: -10%; right: -10%; animation-delay: -5s; }
    @keyframes float { 0% { transform: translate(0, 0); } 100% { transform: translate(40px, 60px); } }

    /* --- 3. ä¸»å¡ç‰‡ (Main Interface) --- */
    .card {
        width: 90%; max-width: 440px; height: auto; min-height: 720px;
        background: var(--card-bg);
        backdrop-filter: blur(50px) saturate(180%); -webkit-backdrop-filter: blur(50px) saturate(180%);
        border-radius: 32px; box-shadow: var(--shadow-soft);
        padding: 40px 36px; position: relative;
        display: flex; flex-direction: column;
        transition: all 0.5s var(--ease-spring);
        border: 1px solid rgba(255,255,255,0.6);
        box-sizing: border-box;
    }

    /* --- 4. é€šç”¨ç»„ä»¶ --- */
    .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; font-size: 11px; font-weight: 700; color: #b0b0b5; letter-spacing: 0.5px; }
    .status-badge { display: flex; align-items: center; gap: 6px; color: #6e6e73; }
    .dot { width: 6px; height: 6px; background-color: #34c759; border-radius: 50%; box-shadow: 0 0 8px #34c759; animation: pulse 3s infinite; }
    @keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }

    h1 { font-size: 32px; font-weight: 800; margin: 10px 0 15px 0; line-height: 1.1; letter-spacing: -0.5px; }
    p { font-size: 15px; line-height: 1.6; color: var(--text-sec); margin-bottom: 20px; }
    .tag-pill { display: inline-block; background: #e8e8ed; padding: 6px 10px; border-radius: 6px; font-size: 11px; font-weight: 600; color: #6e6e73; margin-bottom: 10px; }

    .btn-primary {
        background-color: #1d1d1f; color: #fff; width: 100%; padding: 18px;
        border-radius: 99px; border: none; font-size: 16px; font-weight: 600;
        cursor: pointer; transition: all 0.3s var(--ease-spring);
    }
    .btn-primary:hover { transform: scale(1.02); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
    .btn-primary:active { transform: scale(0.96); }

    /* --- 5. æ³•å¾‹é¡µè„š (Legal Footer) --- */
    .legal-footer {
        margin-top: auto;
        padding-top: 20px;
        border-top: 1px solid rgba(0,0,0,0.05);
        text-align: center;
        font-size: 11px;
        color: #999;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }
    .legal-links { display: flex; justify-content: center; gap: 15px; }
    .legal-link { cursor: pointer; color: var(--text-sec); text-decoration: none; transition: color 0.2s; }
    .legal-link:hover { color: var(--text-main); text-decoration: underline; }

    /* --- 6. æ³•å¾‹æ¨¡æ€æ¡† (Legal Modal) --- */
    .modal-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.4); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
        z-index: 999; display: none; justify-content: center; align-items: center;
        opacity: 0; transition: opacity 0.3s;
    }
    .modal-overlay.show { display: flex; opacity: 1; }

    .modal-content {
        width: 85%; max-width: 500px; max-height: 80vh;
        background: #fff; border-radius: 24px; padding: 30px;
        box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        display: flex; flex-direction: column;
        transform: translateY(20px); transition: transform 0.3s var(--ease-spring);
    }
    .modal-overlay.show .modal-content { transform: translateY(0); }

    .modal-body { overflow-y: auto; margin: 20px 0; font-size: 13px; line-height: 1.6; color: #444; padding-right: 10px; }
    .modal-body h3 { margin-top: 0; font-size: 16px; color: #000; }
    .modal-body p { margin-bottom: 15px; font-size: 13px; color: #555; }

    .btn-close {
        background: #f2f2f7; color: #000; padding: 12px; border-radius: 12px;
        border: none; font-weight: 600; cursor: pointer; width: 100%;
    }
    .btn-close:hover { background: #e5e5ea; }

    /* --- 7. å…¶ä»–æ ·å¼ (Chart, Lang, etc) --- */
    .lang-btn { cursor: pointer; font-size: 12px; padding: 6px 10px; border-radius: 8px; display: flex; gap: 5px; }
    .lang-btn:hover { background: rgba(0,0,0,0.05); }
    .lang-menu { position: absolute; top: 55px; right: 30px; background: rgba(255,255,255,0.95); padding: 8px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: none; flex-direction: column; z-index: 100; }
    .lang-menu.show { display: flex; }
    .lang-item { padding: 8px 12px; font-size: 13px; border-radius: 8px; cursor: pointer; }
    .lang-item:hover { background: #f2f2f7; }

    .screen { display: none; flex-direction: column; height: 100%; }
    .screen.active { display: flex; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    .option-card { background: #fff; border: 1px solid rgba(0,0,0,0.08); padding: 16px; border-radius: 14px; margin-bottom: 10px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s; opacity: 0; animation: slideUp 0.4s forwards; }
    @keyframes slideUp { to { opacity: 1; transform: translateY(0); } }
    .option-card:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }

    .chart-box { position: relative; width: 200px; height: 200px; margin: 20px auto; display: flex; justify-content: center; align-items: center; }
    .circular-chart { width: 100%; height: 100%; transform: rotate(-90deg); }
    .circle-bg { fill: none; stroke: #e5e5ea; stroke-width: 8; }
    .circle-path { fill: none; stroke: var(--accent); stroke-width: 8; stroke-dasharray: 565; stroke-dashoffset: 565; transition: stroke-dashoffset 1.5s ease-out; stroke-linecap: round; }
    .percentage { font-size: 48px; font-weight: 800; color: var(--accent); }

    .data-panel { background: rgba(255,255,255,0.5); border: 1px solid rgba(0,0,0,0.05); border-radius: 16px; padding: 15px; margin-bottom: 20px; }
    .data-stat { font-size: 24px; font-weight: 700; }

</style>
</head>
<body>

<div class="aurora-bg">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
</div>

<div class="modal-overlay" id="legal_modal">
    <div class="modal-content">
        <div class="modal-body">
            <h3 id="legal_title">Terms of Use & Privacy Protocol</h3>
            <div id="legal_text">
                </div>
        </div>
        <button class="btn-close" onclick="closeLegal()">I Understand / æˆ‘å·²äº†è§£</button>
    </div>
</div>

<div class="card">
    <div class="header-bar">
        <span id="txt_agency">SRI INSTITUTE v4.2</span>
        <div style="display: flex; gap: 12px; align-items: center;">
            <div class="lang-btn" onclick="toggleLang()">ğŸŒ <span id="cur_lang">English</span></div>
            <div class="status-badge"><span class="dot"></span> <span id="txt_secure">SECURE</span></div>
        </div>
    </div>
    <div class="lang-menu" id="lang_menu">
        <div class="lang-item" onclick="setLang('en')">ğŸ‡ºğŸ‡¸ English</div>
        <div class="lang-item" onclick="setLang('zh')">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</div>
        <div class="lang-item" onclick="setLang('jp')">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</div>
    </div>

    <div id="screen-home" class="screen active">
        <div style="flex:1;">
            <span class="tag-pill" id="txt_module">PSYCHOMETRIC MODULE</span>
            <h1 id="txt_title">Sexual Orientation<br>Spectrum Analysis</h1>
            <p id="txt_intro">Welcome to the SRI (Spectrum Research Institute) subconscious assessment system.</p>

            <div class="data-panel">
                <h4 style="margin:0 0 5px 0; font-size:11px; color:#888; text-transform:uppercase;">Global Database</h4>
                <div class="data-stat">4,203,192</div>
                <div style="font-size:12px; color:#888; margin-top:2px;" id="txt_data_desc">Verified samples analyzed</div>
            </div>

            <div style="background:#fbfbfd; border-radius:16px; padding:15px; font-size:13px; color:#666; margin-bottom:20px;">
                <strong id="txt_notice_title" style="color:#333; display:block; margin-bottom:8px;">Notice:</strong>
                <ul style="margin:0; padding-left:18px;">
                    <li id="txt_n1">Contains psychological projection scenarios.</li>
                    <li id="txt_n2">Results have clinical reference value.</li>
                </ul>
            </div>
        </div>

        <button class="btn-primary" onclick="startQuiz()" id="txt_btn_start">Start Assessment</button>

        <div class="legal-footer">
            <div class="legal-links">
                <span class="legal-link" onclick="openLegal()">Privacy Policy</span>
                <span class="legal-link" onclick="openLegal()">Terms of Use</span>
                <span class="legal-link" onclick="openLegal()">Research Methodology</span>
            </div>
            <div style="opacity: 0.6;">
                &copy; 2024 Spectrum Research Institute (SRI).<br>
                <span id="txt_grant">Supported by Public Science Grant #GK-2094</span>
            </div>
        </div>
    </div>

    <div id="screen-quiz" class="screen">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
            <span class="tag-pill" id="progress_text">Q1 / 10</span>
        </div>
        <h2 id="question_text" style="font-size:22px; margin-bottom:30px; line-height:1.4;">Loading...</h2>
        <div id="options_box" style="display:flex; flex-direction:column;"></div>
    </div>

    <div id="screen-load" class="screen" style="justify-content:center; text-align:center;">
        <div style="width:40px; height:40px; border:4px solid #eee; border-top-color:#000; border-radius:50%; animation:spin 1s linear infinite; margin:0 auto 20px auto;"></div>
        <h3 id="txt_processing">Analyzing Data...</h3>
        <style>@keyframes spin { to { transform: rotate(360deg); } }</style>
    </div>

    <div id="screen-result" class="screen">
        <div style="text-align:center; height:100%; display:flex; flex-direction:column;">
            <span style="font-size:11px; color:#888; letter-spacing:1px; margin-bottom:10px;">REPORT ID: #9402-GAY</span>
            <h2 id="txt_report_title">Analysis Report</h2>

            <div class="chart-box">
                <svg class="circular-chart">
                    <circle class="circle-bg" cx="100" cy="100" r="90"></circle>
                    <circle id="circle-path" class="circle-path" cx="100" cy="100" r="90"></circle>
                </svg>
                <div style="position:absolute; text-align:center;">
                    <div class="percentage" id="final_score">0%</div>
                    <div style="font-size:11px; text-transform:uppercase; color:#888; margin-top:5px;" id="txt_chart_label">Gay Index</div>
                </div>
            </div>

            <div style="background:#fbfbfd; border:1px solid #eee; border-radius:20px; padding:20px; text-align:left; margin-bottom:20px;">
                <strong id="txt_con_title" style="display:block; margin-bottom:10px;">Conclusion: High-Spectrum</strong>
                <p id="txt_con_desc" style="margin:0; font-size:14px; color:#444;">Your subconscious response patterns show an extremely high correlation with the homosexual spectrum.</p>
            </div>

            <button class="btn-primary" style="background:#f2f2f7; color:#000; margin-top:auto;" onclick="resetApp()" id="txt_btn_restart">Recalibrate</button>
        </div>
    </div>
</div>

<script>
    // --- 1. å†…å®¹æ•°æ®åº“ (å«å…è´£å£°æ˜) ---
    const i18n = {
        en: {
            agency: "SRI INSTITUTE v4.2", secure: "SECURE",
            module: "PSYCHOMETRIC MODULE", title: "Sexual Orientation<br>Spectrum Analysis",
            intro: "The SRI system analyzes micro-reactions to scientifically determine spectrum position.",
            data_desc: "Verified samples analyzed", grant: "Supported by Public Science Grant #GK-2094",
            notice_title: "Notice:", n1: "Contains psychological projection scenarios.", n2: "Results have clinical reference value.",
            btn_start: "Start Assessment", processing: "Analyzing Neural Patterns...",
            report_title: "Analysis Report", chart_label: "Homosexual Index",
            con_title: "Conclusion: High-Spectrum Homosexual",
            con_desc: "Your subconscious patterns indicate extremely high correlation with the homosexual spectrum (>99% confidence).",
            btn_restart: "Recalibrate Data",
            // æ³•å¾‹æ¡æ¬¾æ–‡æ¡ˆ
            legal_title: "Terms of Use & Disclaimer",
            legal_text: "<p><strong>1. Non-Profit Research Purpose</strong><br>This tool is provided by the Spectrum Research Institute (SRI) as part of the Global Open Science Initiative. Access is free of charge, supported by Public Grant #GK-2094.</p><p><strong>2. Medical Disclaimer</strong><br>The results generated by this algorithm are based on the Kinsey-Klein Scale revisions. While statistically significant, they do not constitute a medical diagnosis. Please consult a licensed professional for clinical advice.</p><p><strong>3. Data Privacy</strong><br>This session operates in 'Anonymous Mode'. No personally identifiable information (PII) is stored on our servers. All computation is performed locally within your browser sandbox.</p><p><strong>4. Limitation of Liability</strong><br>By using this tool, you acknowledge that the analysis is for educational and self-discovery purposes only.</p>"
        },
        zh: {
            agency: "SRI ç ”ç©¶é™¢ v4.2", secure: "å®‰å…¨è¿æ¥",
            module: "å¿ƒç†æµ‹é‡æ¨¡å—", title: "æ€§å–å‘å…‰è°±è¯„ä¼°<br>ç»¼åˆåˆ†æç³»ç»Ÿ",
            intro: "SRI ç³»ç»Ÿé€šè¿‡åˆ†æå¾®è¡¨æƒ…ååº”ï¼Œç§‘å­¦ç•Œå®šæ‚¨çš„å…‰è°±ä½ç½®ã€‚",
            data_desc: "å·²éªŒè¯çš„å…¨çƒæ ·æœ¬", grant: "ç”±å…¬å…±ç§‘å­¦åŸºé‡‘ #GK-2094 æä¾›æ”¯æŒ",
            notice_title: "é¡»çŸ¥ï¼š", n1: "åŒ…å«å¿ƒç†æŠ•å°„æƒ…å¢ƒã€‚", n2: "ç»“æœå…·æœ‰ä¸´åºŠå‚è€ƒä»·å€¼ã€‚",
            btn_start: "å¼€å§‹ä¸“ä¸šè¯„ä¼°", processing: "æ­£åœ¨åˆ†æç¥ç»å…ƒæ¨¡å¼...",
            report_title: "åˆ†ææŠ¥å‘Š", chart_label: "åŒæ€§æ‹æŒ‡æ•°",
            con_title: "ä¸´åºŠç»“è®ºï¼šé«˜çº¯åº¦åŒæ€§æ‹",
            con_desc: "æ‚¨çš„æ½œæ„è¯†æ¨¡å¼æ˜¾ç¤ºï¼Œæ‚¨ä¸åŒæ€§æ‹å…‰è°±å…·æœ‰æé«˜çš„ç›¸å…³æ€§ï¼ˆç½®ä¿¡åº¦ >99%ï¼‰ã€‚",
            btn_restart: "é‡æ–°æ ¡å‡†æ•°æ®",
            // æ³•å¾‹æ¡æ¬¾æ–‡æ¡ˆ
            legal_title: "ä½¿ç”¨æ¡æ¬¾ä¸å…è´£å£°æ˜",
            legal_text: "<p><strong>1. éè¥åˆ©ç ”ç©¶ç›®çš„</strong><br>æœ¬å·¥å…·ç”±å…‰è°±ç ”ç©¶é™¢ (SRI) æä¾›ï¼Œå±äºå…¨çƒå¼€æ”¾ç§‘å­¦è®¡åˆ’çš„ä¸€éƒ¨åˆ†ã€‚æœ¬æœåŠ¡å®Œå…¨å…è´¹ï¼Œç”±å…¬å…±åŸºé‡‘ #GK-2094 æä¾›èµ„é‡‘æ”¯æŒã€‚</p><p><strong>2. åŒ»ç–—å…è´£å£°æ˜</strong><br>æœ¬ç®—æ³•ç”Ÿæˆçš„ç»“æœåŸºäºä¿®è®¢ç‰ˆã€Šé‡‘èµ›-å…‹è±å› é‡è¡¨ã€‹ã€‚è™½ç„¶å…·æœ‰ç»Ÿè®¡å­¦æ„ä¹‰ï¼Œä½†ç»“æœä¸æ„æˆæ­£å¼çš„åŒ»ç–—è¯Šæ–­ã€‚å¦‚éœ€ä¸´åºŠå»ºè®®ï¼Œè¯·å’¨è¯¢æ‰§ä¸šåŒ»å¸ˆã€‚</p><p><strong>3. æ•°æ®éšç§</strong><br>æœ¬æ¬¡ä¼šè¯åœ¨â€œåŒ¿åæ¨¡å¼â€ä¸‹è¿è¡Œã€‚æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸å­˜å‚¨ä»»ä½•ä¸ªäººèº«ä»½ä¿¡æ¯ (PII)ã€‚æ‰€æœ‰è®¡ç®—å‡åœ¨æ‚¨çš„æµè§ˆå™¨æ²™ç›’ä¸­æœ¬åœ°æ‰§è¡Œã€‚</p><p><strong>4. è´£ä»»é™åˆ¶</strong><br>ä½¿ç”¨æœ¬å·¥å…·å³è¡¨ç¤ºæ‚¨çŸ¥æ‚‰ï¼šæœ¬åˆ†æä»…ç”¨äºæ•™è‚²å’Œè‡ªæˆ‘æ¢ç´¢ç›®çš„ã€‚</p>"
        },
        jp: {
            agency: "SRI ç ”ç©¶æ‰€ v4.2", secure: "ä¿è­·ã•ã‚ŒãŸé€šä¿¡",
            module: "å¿ƒç†æ¸¬å®šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«", title: "æ€§çš„æŒ‡å‘ã‚¹ãƒšã‚¯ãƒˆãƒ«<br>ç·åˆåˆ†æã‚·ã‚¹ãƒ†ãƒ ",
            intro: "SRIã‚·ã‚¹ãƒ†ãƒ ã¯å¾®ç´°ãªåå¿œã‚’åˆ†æã—ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«ä½ç½®ã‚’ç‰¹å®šã—ã¾ã™ã€‚",
            data_desc: "æ¤œè¨¼æ¸ˆã¿ã‚µãƒ³ãƒ—ãƒ«", grant: "å…¬çš„ç ”ç©¶åŠ©æˆé‡‘ #GK-2094 ã«ã‚ˆã‚Šæ”¯æ´",
            notice_title: "æ³¨æ„äº‹é …ï¼š", n1: "å¿ƒç†æŠ•å½±ã‚·ãƒŠãƒªã‚ªã‚’å«ã¿ã¾ã™ã€‚", n2: "çµæœã¯è‡¨åºŠçš„å‚ç…§ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ã€‚",
            btn_start: "è¨ºæ–­ã‚’é–‹å§‹", processing: "ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æä¸­...",
            report_title: "åˆ†æãƒ¬ãƒãƒ¼ãƒˆ", chart_label: "åŒæ€§æ„›æŒ‡æ•°",
            con_title: "è‡¨åºŠçš„çµè«–ï¼šé«˜ã‚¹ãƒšã‚¯ãƒˆãƒ«åŒæ€§æ„›",
            con_desc: "ã‚ãªãŸã®æ½œåœ¨æ„è­˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ã€åŒæ€§æ„›ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨æ¥µã‚ã¦é«˜ã„ç›¸é–¢ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚",
            btn_restart: "ãƒ‡ãƒ¼ã‚¿ã‚’å†èª¿æ•´",
            legal_title: "åˆ©ç”¨è¦ç´„ã¨å…è²¬äº‹é …",
            legal_text: "<p><strong>1. éå–¶åˆ©ç ”ç©¶ç›®çš„</strong><br>æœ¬ãƒ„ãƒ¼ãƒ«ã¯Spectrum Research Institute (SRI)ã«ã‚ˆã‚Šæä¾›ã•ã‚Œã€åˆ©ç”¨ã¯ç„¡æ–™ã§ã™ã€‚</p><p><strong>2. å…è²¬äº‹é …</strong><br>çµæœã¯åŒ»ç™‚è¨ºæ–­ã‚’æ§‹æˆã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p><p><strong>3. ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼</strong><br>åŒ¿åãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã—ã€å€‹äººæƒ…å ±ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚</p>"
        }
    };

    // ç®€åŒ–çš„é¢˜ç›®
    const questions = [
        {en:{q:"Gym peripheral vision drawn to:",o:["Same-sex physique","Opposite-sex face","Equipment","Space"]},zh:{q:"å¥èº«æˆ¿ä½™å…‰é¦–å…ˆè¢«ä»€ä¹ˆå¸å¼•ï¼Ÿ",o:["åŒæ€§èº«æ","å¼‚æ€§é¢å­”","å™¨æ","ç©ºé—´"]},jp:{q:"ã‚¸ãƒ ã§è¦–ç·šãŒå‘ãã®ã¯ï¼Ÿ",o:["åŒæ€§ã®ä½“æ ¼","ç•°æ€§ã®é¡”","å™¨å…·","ã‚¹ãƒšãƒ¼ã‚¹"]}},
        {en:{q:"If gender didn't exist, you'd love:",o:["Soulmates (often same-sex)","Opposite sex","Anyone","No one"]},zh:{q:"è‹¥æ— æ€§åˆ«æ ‡ç­¾ï¼Œä½ ä¼šçˆ±ä¸Šï¼š",o:["çµé­‚ä¼´ä¾£(å¸¸ä¸ºåŒæ€§)","ä»…é™å¼‚æ€§","ä»»ä½•äºº","è°éƒ½ä¸çˆ±"]},jp:{q:"æ€§åˆ¥ãŒãªã‹ã£ãŸã‚‰ï¼Ÿ",o:["é­‚ã®ä¼´ä¾¶","ç•°æ€§","èª°ã§ã‚‚","èª°ã‚‚"]}},
        {en:{q:"Scroll pause time longest on:",o:["Same-sex fitness/style","Dating content","News","Scenery"]},zh:{q:"ç¤¾äº¤åª’ä½“åœç•™æ—¶é—´æœ€é•¿ï¼š",o:["åŒæ€§ç©¿æ­/å¥èº«","çº¦ä¼šå†…å®¹","æ–°é—»","é£æ™¯"]},jp:{q:"SNSã§ç›®ãŒç•™ã¾ã‚‹ã®ã¯ï¼Ÿ",o:["åŒæ€§","ç•°æ€§","ãƒ‹ãƒ¥ãƒ¼ã‚¹","é¢¨æ™¯"]}},
        {en:{q:"Most spiritual bond:",o:["Brotherhood/Sisterhood","Marriage","Parenting","Work"]},zh:{q:"æœ€æ·±åˆ»çš„çµé­‚çº½å¸¦ï¼š",o:["å…„å¼Ÿ/å§å¦¹æƒ…è°Š","å©šå§»","è‚²å„¿","å·¥ä½œ"]},jp:{q:"ç²¾ç¥çš„ãªçµ†ã¯ï¼Ÿ",o:["åŒæ€§ã®çµ†","çµå©š","è‚²å…","ä»•äº‹"]}}
    ];

    let currentLang = 'en';
    let currentStep = 0;
    const totalQs = 10;

    function toggleLang() { document.getElementById('lang_menu').classList.toggle('show'); }
    function setLang(lang) {
        currentLang = lang;
        document.getElementById('lang_menu').classList.remove('show');
        const flags = {en:'English',zh:'ä¸­æ–‡',jp:'æ—¥æœ¬èª'};
        document.getElementById('cur_lang').innerText = flags[lang];
        refreshText();
    }

    function refreshText() {
        const t = i18n[currentLang];
        const map = {
            'txt_agency': t.agency, 'txt_secure': t.secure, 'txt_module': t.module, 'txt_title': t.title,
            'txt_intro': t.intro, 'txt_data_desc': t.data_desc, 'txt_grant': t.grant,
            'txt_notice_title': t.notice_title, 'txt_n1': t.n1, 'txt_n2': t.n2,
            'txt_btn_start': t.btn_start, 'txt_processing': t.processing,
            'txt_report_title': t.report_title, 'txt_chart_label': t.chart_label,
            'txt_con_title': t.con_title, 'txt_con_desc': t.con_desc, 'txt_btn_restart': t.btn_restart,
            'legal_title': t.legal_title, 'legal_text': t.legal_text // æ³¨å…¥æ³•å¾‹æ–‡æœ¬
        };
        for(let id in map) {
            const el = document.getElementById(id);
            if(el) el.innerHTML = map[id]; // ä½¿ç”¨innerHTMLæ”¯æŒæ ‡ç­¾
        }
        if(document.getElementById('screen-quiz').classList.contains('active')) loadQuestion(currentStep);
    }

    // --- æ³•å¾‹æ¨¡æ€æ¡†æ§åˆ¶ ---
    function openLegal() {
        const modal = document.getElementById('legal_modal');
        modal.style.display = 'flex';
        setTimeout(() => modal.classList.add('show'), 10);
    }
    function closeLegal() {
        const modal = document.getElementById('legal_modal');
        modal.classList.remove('show');
        setTimeout(() => modal.style.display = 'none', 300);
    }

    // å±å¹•åˆ‡æ¢
    function switchScreen(id) {
        document.querySelectorAll('.screen').forEach(el => { el.classList.remove('active'); el.style.display='none'; });
        const t = document.getElementById(id);
        t.style.display='flex'; setTimeout(()=>t.classList.add('active'),10);
    }

    function startQuiz() { currentStep=0; switchScreen('screen-quiz'); loadQuestion(0); }

    function loadQuestion(i) {
        const q = questions[i%questions.length][currentLang];
        document.getElementById('progress_text').innerText = `Q${i+1} / 10`;
        document.getElementById('question_text').innerText = q.q;
        const box = document.getElementById('options_box'); box.innerHTML='';
        q.o.forEach((opt,idx)=>{
            const d = document.createElement('div'); d.className='option-card'; d.innerText=opt;
            d.style.animationDelay=`${idx*0.1}s`; d.onclick=nextStep; box.appendChild(d);
        });
    }

    function nextStep() {
        if(currentStep<9) { // æ¨¡æ‹Ÿ10é¢˜
            currentStep++;
            const s = document.getElementById('screen-quiz'); s.style.opacity=0;
            setTimeout(()=>{ loadQuestion(currentStep); s.style.opacity=1; },250);
        } else {
            switchScreen('screen-load'); setTimeout(showResult, 2500);
        }
    }

    function showResult() {
        switchScreen('screen-result');
        const score = Math.floor(Math.random()*(99-75+1))+75;
        const offset = 565 - (565*(score/100));
        const c = document.getElementById('circle-path'); c.style.strokeDashoffset = 565;
        setTimeout(()=>c.style.strokeDashoffset=offset,100);
        let curr=0; const num=document.getElementById('final_score');
        const t = setInterval(()=>{ if(curr<score){curr++;num.innerText=curr+'%';}else clearInterval(t); },20);
    }

    function resetApp() { switchScreen('screen-home'); document.getElementById('final_score').innerText='0%'; document.getElementById('circle-path').style.strokeDashoffset=565; }

    refreshText();
</script>
</body>
</html>
